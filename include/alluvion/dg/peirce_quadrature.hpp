#ifndef ALLUVION_DG_PEIRCE_QUADRATURE_HPP
#define ALLUVION_DG_PEIRCE_QUADRATURE_HPP

#include <Eigen/Dense>

#include "alluvion/dg/common.hpp"

namespace alluvion {
namespace dg {
constexpr U kPeirceM = 14;
constexpr U kNumPhi = 2 * kPeirceM + 2;
constexpr U kNumTheta = 4 * kPeirceM + 4;
constexpr U kNumR = kPeirceM + 1;

template <typename TF>
struct PeirceConst {
  constexpr PeirceConst() : cosphi(), sinphi(), r(), b(), c() {
    if constexpr (kPeirceM == 7) {
      cosphi[0] = -0.989400934991649932596154173450;
      cosphi[1] = -0.944575023073232576077988415535;
      cosphi[2] = -0.865631202387831743880467897712;
      cosphi[3] = -0.755404408355003033895101194847;
      cosphi[4] = -0.617876244402643748446671764049;
      cosphi[5] = -0.458016777657227386342419442984;
      cosphi[6] = -0.281603550779258913230460501460;
      cosphi[7] = -0.0950125098376374401853193354250;
      cosphi[8] = 0.0950125098376374401853193354250;
      cosphi[9] = 0.281603550779258913230460501460;
      cosphi[10] = 0.458016777657227386342419442984;
      cosphi[11] = 0.617876244402643748446671764049;
      cosphi[12] = 0.755404408355003033895101194847;
      cosphi[13] = 0.865631202387831743880467897712;
      cosphi[14] = 0.944575023073232576077988415535;
      cosphi[15] = 0.989400934991649932596154173450;

      sinphi[0] = 0.145209468829167280282880949784;
      sinphi[1] = 0.328295637781256768450207178290;
      sinphi[2] = 0.500682156115630586381637460127;
      sinphi[3] = 0.655258864753333819831390558218;
      sinphi[4] = 0.786275363090364449654701638116;
      sinphi[5] = 0.888943547917689727168085390228;
      sinphi[6] = 0.959530843792169792240614445637;
      sinphi[7] = 0.995476078554554141853594593613;
      sinphi[8] = 0.995476078554554141853594593613;
      sinphi[9] = 0.959530843792169792240614445637;
      sinphi[10] = 0.888943547917689727168085390228;
      sinphi[11] = 0.786275363090364449654701638116;
      sinphi[12] = 0.655258864753333819831390558218;
      sinphi[13] = 0.500682156115630586381637460127;
      sinphi[14] = 0.328295637781256768450207178290;
      sinphi[15] = 0.145209468829167280282880949784;

      r[0] = 0.178484181495847855850677493654;
      r[1] = 0.351231763453876315297185517095;
      r[2] = 0.512690537086476967886246568630;
      r[3] = 0.657671159216690765850302216643;
      r[4] = 0.781514003896801406925230055520;
      r[5] = 0.880239153726985902122955694488;
      r[6] = 0.950675521768767761222716957896;
      r[7] = 0.990575475314417335675434019941;

      b[0] = 0.0271524594117540948517805724560;
      b[1] = 0.0622535239386478928628438369944;
      b[2] = 0.0951585116824927848099251076022;
      b[3] = 0.124628971255533872052476282192;
      b[4] = 0.149595988816576732081501730547;
      b[5] = 0.169156519395002538189312079030;
      b[6] = 0.182603415044923588866763667969;
      b[7] = 0.189450610455068496285396723208;
      b[8] = 0.189450610455068496285396723208;
      b[9] = 0.182603415044923588866763667969;
      b[10] = 0.169156519395002538189312079030;
      b[11] = 0.149595988816576732081501730547;
      b[12] = 0.124628971255533872052476282192;
      b[13] = 0.0951585116824927848099251076022;
      b[14] = 0.0622535239386478928628438369944;
      b[15] = 0.0271524594117540948517805724560;

      c[0] = 0.00562468801729387510978164823574;
      c[1] = 0.0207256163361080832976198832636;
      c[2] = 0.0404911727416291986723229686404;
      c[3] = 0.0584507163831210890389534044078;
      c[4] = 0.0683346415192924710976504217793;
      c[5] = 0.0658877907331894786007565847476;
      c[6] = 0.0501234323946693489415882264535;
      c[7] = 0.0236952752080297885746601958053;
    } else if constexpr (kPeirceM == 10) {
      cosphi[0] = -0.994294585482399292073031421161;
      cosphi[1] = -0.970060497835428727123950986765;
      cosphi[2] = -0.926956772187174000520692939259;
      cosphi[3] = -0.865812577720300136536425637019;
      cosphi[4] = -0.787816805979208162004277955408;
      cosphi[5] = -0.694487263186682780050689835762;
      cosphi[6] = -0.587640403506911592958876927639;
      cosphi[7] = -0.469355837986757026406330710966;
      cosphi[8] = -0.341935820892084225158147420427;
      cosphi[9] = -0.207860426688221285478846533920;
      cosphi[10] = -0.0697392733197222212138417961186;
      cosphi[11] = 0.0697392733197222212138417961186;
      cosphi[12] = 0.207860426688221285478846533920;
      cosphi[13] = 0.341935820892084225158147420427;
      cosphi[14] = 0.469355837986757026406330710966;
      cosphi[15] = 0.587640403506911592958876927639;
      cosphi[16] = 0.694487263186682780050689835762;
      cosphi[17] = 0.787816805979208162004277955408;
      cosphi[18] = 0.865812577720300136536425637019;
      cosphi[19] = 0.926956772187174000520692939259;
      cosphi[20] = 0.970060497835428727123950986765;
      cosphi[21] = 0.994294585482399292073031421161;

      sinphi[0] = 0.106669008059434802898238699383;
      sinphi[1] = 0.242863398928863255374935800454;
      sinphi[2] = 0.375168152294855115031260252485;
      sinphi[3] = 0.500368444509972306891706073691;
      sinphi[4] = 0.615909636405145623210174202514;
      sinphi[5] = 0.719504997391589494324622485538;
      sinphi[6] = 0.809122213368434302312155161061;
      sinphi[7] = 0.883009115098903772316880165371;
      sinphi[8] = 0.939723307357467055991286328357;
      sinphi[9] = 0.978158495856878290786765465823;
      sinphi[10] = 0.997565252881653391622780777004;
      sinphi[11] = 0.997565252881653391622780777004;
      sinphi[12] = 0.978158495856878290786765465823;
      sinphi[13] = 0.939723307357467055991286328357;
      sinphi[14] = 0.883009115098903772316880165371;
      sinphi[15] = 0.809122213368434302312155161061;
      sinphi[16] = 0.719504997391589494324622485538;
      sinphi[17] = 0.615909636405145623210174202514;
      sinphi[18] = 0.500368444509972306891706073691;
      sinphi[19] = 0.375168152294855115031260252485;
      sinphi[20] = 0.242863398928863255374935800454;
      sinphi[21] = 0.106669008059434802898238699383;

      r[0] = 0.133256824298466110931742682242;
      r[1] = 0.264135680970344930533869538283;
      r[2] = 0.390301038030290831421488872881;
      r[3] = 0.509501477846007549689793047867;
      r[4] = 0.619609875763646156385097311650;
      r[5] = 0.718661363131950194461624483749;
      r[6] = 0.804888401618839892151118406997;
      r[7] = 0.876752358270441667378156885934;
      r[8] = 0.932971086826016102349196989038;
      r[9] = 0.972542471218115231956024076821;
      r[10] = 0.994769334997552123523925715446;

      b[0] = 0.0146279952982722006849910980472;
      b[1] = 0.0337749015848141547933022468659;
      b[2] = 0.0522933351526832859403120512732;
      b[3] = 0.0697964684245204880949614189302;
      b[4] = 0.0859416062170677274144436813727;
      b[5] = 0.100414144442880964932078837831;
      b[6] = 0.112932296080539218393400607422;
      b[7] = 0.123252376810512424285560986155;
      b[8] = 0.131173504787062370732964992530;
      b[9] = 0.136541498346015171352573831232;
      b[10] = 0.139251872855631993375410248342;
      b[11] = 0.139251872855631993375410248342;
      b[12] = 0.136541498346015171352573831232;
      b[13] = 0.131173504787062370732964992530;
      b[14] = 0.123252376810512424285560986155;
      b[15] = 0.112932296080539218393400607422;
      b[16] = 0.100414144442880964932078837831;
      b[17] = 0.0859416062170677274144436813727;
      b[18] = 0.0697964684245204880949614189302;
      b[19] = 0.0522933351526832859403120512732;
      b[20] = 0.0337749015848141547933022468659;
      b[21] = 0.0146279952982722006849910980472;

      c[0] = 0.00235217893116765503577576571354;
      c[1] = 0.00899345033491989196928951740269;
      c[2] = 0.0187446699883365963716270199424;
      c[3] = 0.0298521797610717991754872875261;
      c[4] = 0.0402697939488410687848334660692;
      c[5] = 0.0479885917489028053580734309006;
      c[6] = 0.0513620930936860591786467554177;
      c[7] = 0.0493751217592713848935425069925;
      c[8] = 0.0418136731400463210209943467781;
      c[9] = 0.0293096600814730676911275767778;
      c[10] = 0.0132719205456166838539356598129;
    } else if constexpr (kPeirceM == 14) {
      cosphi[0] = -0.996893484074649540271630050919;
      cosphi[1] = -0.983668123279747209970032581606;
      cosphi[2] = -0.960021864968307512216871025582;
      cosphi[3] = -0.926200047429274325879324277080;
      cosphi[4] = -0.882560535792052681543116462530;
      cosphi[5] = -0.829565762382768397442898119733;
      cosphi[6] = -0.767777432104826194917977340975;
      cosphi[7] = -0.697850494793315796932292388027;
      cosphi[8] = -0.620526182989242861140477556431;
      cosphi[9] = -0.536624148142019899264169793311;
      cosphi[10] = -0.447033769538089176780609900323;
      cosphi[11] = -0.352704725530878113471037207089;
      cosphi[12] = -0.254636926167889846439805129818;
      cosphi[13] = -0.153869913608583546963794672743;
      cosphi[14] = -0.0514718425553176958330252131667;
      cosphi[15] = 0.0514718425553176958330252131667;
      cosphi[16] = 0.153869913608583546963794672743;
      cosphi[17] = 0.254636926167889846439805129818;
      cosphi[18] = 0.352704725530878113471037207089;
      cosphi[19] = 0.447033769538089176780609900323;
      cosphi[20] = 0.536624148142019899264169793311;
      cosphi[21] = 0.620526182989242861140477556431;
      cosphi[22] = 0.697850494793315796932292388027;
      cosphi[23] = 0.767777432104826194917977340975;
      cosphi[24] = 0.829565762382768397442898119733;
      cosphi[25] = 0.882560535792052681543116462530;
      cosphi[26] = 0.926200047429274325879324277080;
      cosphi[27] = 0.960021864968307512216871025582;
      cosphi[28] = 0.983668123279747209970032581606;
      cosphi[29] = 0.996893484074649540271630050919;

      sinphi[0] = 0.0787615477851118885289263870662;
      sinphi[1] = 0.179991731041456582326565820688;
      sinphi[2] = 0.279925023502317022588530040326;
      sinphi[3] = 0.377032455024776334181181780339;
      sinphi[4] = 0.470198788452761644959731862429;
      sinphi[5] = 0.558409030982035820857535864081;
      sinphi[6] = 0.640716641543294864424264245209;
      sinphi[7] = 0.716243455060305819333878170949;
      sinphi[8] = 0.784185728144041578127354785240;
      sinphi[9] = 0.843821381354402207290637222639;
      sinphi[10] = 0.894517081386692454927108498342;
      sinphi[11] = 0.935734672109668028131749832746;
      sinphi[12] = 0.967036729308545247648253898443;
      sinphi[13] = 0.988091114060888129683563625864;
      sinphi[14] = 0.998674446165496209294610406551;
      sinphi[15] = 0.998674446165496209294610406551;
      sinphi[16] = 0.988091114060888129683563625864;
      sinphi[17] = 0.967036729308545247648253898443;
      sinphi[18] = 0.935734672109668028131749832746;
      sinphi[19] = 0.894517081386692454927108498342;
      sinphi[20] = 0.843821381354402207290637222639;
      sinphi[21] = 0.784185728144041578127354785240;
      sinphi[22] = 0.716243455060305819333878170949;
      sinphi[23] = 0.640716641543294864424264245209;
      sinphi[24] = 0.558409030982035820857535864081;
      sinphi[25] = 0.470198788452761644959731862429;
      sinphi[26] = 0.377032455024776334181181780339;
      sinphi[27] = 0.279925023502317022588530040326;
      sinphi[28] = 0.179991731041456582326565820688;
      sinphi[29] = 0.0787615477851118885289263870662;

      r[0] = 0.0995553121523415203251747901189;
      r[1] = 0.198121199335570628772412996033;
      r[2] = 0.294718069981701616617903897672;
      r[3] = 0.388385901608232943061351461288;
      r[4] = 0.478193782044902480440594039356;
      r[5] = 0.563249161407149262720944923595;
      r[6] = 0.642706722924260346184418203233;
      r[7] = 0.715776784586853283905970865366;
      r[8] = 0.781733148416624940406360020195;
      r[9] = 0.839920320146267340086904535940;
      r[10] = 0.889760029948271043374192008982;
      r[11] = 0.930756997896648164956945759729;
      r[12] = 0.962503925092949661789052404106;
      r[13] = 0.984685909665152484002465166735;
      r[14] = 0.997087481819477074055626554223;

      b[0] = 0.00796819249616660561546588347467;
      b[1] = 0.0184664683110909591423021319120;
      b[2] = 0.0287847078833233693497191796113;
      b[3] = 0.0387991925696270495968019364463;
      b[4] = 0.0484026728305940529029381404228;
      b[5] = 0.0574931562176190664817216894021;
      b[6] = 0.0659742298821804951281285151160;
      b[7] = 0.0737559747377052062682438500222;
      b[8] = 0.0807558952294202153546949384605;
      b[9] = 0.0868997872010829798023875307151;
      b[10] = 0.0921225222377861287176327070876;
      b[11] = 0.0963687371746442596394686263518;
      b[12] = 0.0995934205867952670627802821036;
      b[13] = 0.101762389748405504596428952169;
      b[14] = 0.102852652893558840341285636705;
      b[15] = 0.102852652893558840341285636705;
      b[16] = 0.101762389748405504596428952169;
      b[17] = 0.0995934205867952670627802821036;
      b[18] = 0.0963687371746442596394686263518;
      b[19] = 0.0921225222377861287176327070876;
      b[20] = 0.0868997872010829798023875307151;
      b[21] = 0.0807558952294202153546949384605;
      b[22] = 0.0737559747377052062682438500222;
      b[23] = 0.0659742298821804951281285151160;
      b[24] = 0.0574931562176190664817216894021;
      b[25] = 0.0484026728305940529029381404228;
      b[26] = 0.0387991925696270495968019364463;
      b[27] = 0.0287847078833233693497191796113;
      b[28] = 0.0184664683110909591423021319120;
      b[29] = 0.00796819249616660561546588347467;

      c[0] = 0.000983444902407729719939842893634;
      c[1] = 0.00383662234147764057122139270025;
      c[2] = 0.00827679050738779696584700230420;
      c[3] = 0.0138610363714450691825861412857;
      c[4] = 0.0200261113745100043452936295047;
      c[5] = 0.0261391451478931685946495660882;
      c[6] = 0.0315547245550585320209801801404;
      c[7] = 0.0356732580446867417099488960509;
      c[8] = 0.0379954295918633727117300690815;
      c[9] = 0.0381678929473491669950550231422;
      c[10] = 0.0360161358653990210344337103840;
      c[11] = 0.0315615918119668247913271042392;
      c[12] = 0.0250215282546042049733990484680;
      c[13] = 0.0167922445303442940865875623670;
      c[14] = 0.00742737708693976563033416468332;
    } else if constexpr (kPeirceM == 20) {
      cosphi[0] = -0.998399618990062415022868126847;
      cosphi[1] = -0.991577288340860919792361253281;
      cosphi[2] = -0.979342508063748193708982566543;
      cosphi[3] = -0.961759365338204488746927157853;
      cosphi[4] = -0.938923557354988178533173433626;
      cosphi[5] = -0.910959724904127452583847879209;
      cosphi[6] = -0.878020569812172742711985103479;
      cosphi[7] = -0.840285983261816900925439995086;
      cosphi[8] = -0.797962053255487413232705952546;
      cosphi[9] = -0.751279935689480489568472175915;
      cosphi[10] = -0.700494590556171213741569929055;
      cosphi[11] = -0.645883388869247833957496303718;
      cosphi[12] = -0.587744597485109322840711345474;
      cosphi[13] = -0.526395749931192287592867558792;
      cosphi[14] = -0.462171912070421929759075029931;
      cosphi[15] = -0.395423852042975057677093954594;
      cosphi[16] = -0.326516124465411512197156589375;
      cosphi[17] = -0.255825079342879083966414791019;
      cosphi[18] = -0.183736806564854550852755639381;
      cosphi[19] = -0.110645027208519868349122545003;
      cosphi[20] = -0.0369489431653517758130959800376;
      cosphi[21] = 0.0369489431653517758130959800376;
      cosphi[22] = 0.110645027208519868349122545003;
      cosphi[23] = 0.183736806564854550852755639381;
      cosphi[24] = 0.255825079342879083966414791019;
      cosphi[25] = 0.326516124465411512197156589375;
      cosphi[26] = 0.395423852042975057677093954594;
      cosphi[27] = 0.462171912070421929759075029931;
      cosphi[28] = 0.526395749931192287592867558792;
      cosphi[29] = 0.587744597485109322840711345474;
      cosphi[30] = 0.645883388869247833957496303718;
      cosphi[31] = 0.700494590556171213741569929055;
      cosphi[32] = 0.751279935689480489568472175915;
      cosphi[33] = 0.797962053255487413232705952546;
      cosphi[34] = 0.840285983261816900925439995086;
      cosphi[35] = 0.878020569812172742711985103479;
      cosphi[36] = 0.910959724904127452583847879209;
      cosphi[37] = 0.938923557354988178533173433626;
      cosphi[38] = 0.961759365338204488746927157853;
      cosphi[39] = 0.979342508063748193708982566543;
      cosphi[40] = 0.991577288340860919792361253281;
      cosphi[41] = 0.998399618990062415022868126847;
      sinphi[0] = 0.0565526374318492869156977554605;
      sinphi[1] = 0.129516335829057343734624535465;
      sinphi[2] = 0.202208436766143128652929338032;
      sinphi[3] = 0.273895825423196448926765990921;
      sinphi[4] = 0.344125781428614011816273853050;
      sinphi[5] = 0.412495308582529740568591326903;
      sinphi[6] = 0.478622898518977559141458169174;
      sinphi[7] = 0.542143400156934094361869653361;
      sinphi[8] = 0.602707691641882623632435164893;
      sinphi[9] = 0.659983680275815653256003596318;
      sinphi[10] = 0.713657711092328944234403543243;
      sinphi[11] = 0.763436079827758718973881102780;
      sinphi[12] = 0.809046530260816843123182265771;
      sinphi[13] = 0.850239680592700680824873390490;
      sinphi[14] = 0.886790349345982779199356090668;
      sinphi[15] = 0.918498762783867537586570802886;
      sinphi[16] = 0.945191631609213887737576665305;
      sinphi[17] = 0.966723087951875504081167952902;
      sinphi[18] = 0.982975475743596169615271570208;
      sinphi[19] = 0.993859989110149205844192807182;
      sinphi[20] = 0.999317154660603034068065591104;
      sinphi[21] = 0.999317154660603034068065591104;
      sinphi[22] = 0.993859989110149205844192807182;
      sinphi[23] = 0.982975475743596169615271570208;
      sinphi[24] = 0.966723087951875504081167952902;
      sinphi[25] = 0.945191631609213887737576665305;
      sinphi[26] = 0.918498762783867537586570802886;
      sinphi[27] = 0.886790349345982779199356090668;
      sinphi[28] = 0.850239680592700680824873390490;
      sinphi[29] = 0.809046530260816843123182265771;
      sinphi[30] = 0.763436079827758718973881102780;
      sinphi[31] = 0.713657711092328944234403543243;
      sinphi[32] = 0.659983680275815653256003596318;
      sinphi[33] = 0.602707691641882623632435164893;
      sinphi[34] = 0.542143400156934094361869653361;
      sinphi[35] = 0.478622898518977559141458169174;
      sinphi[36] = 0.412495308582529740568591326903;
      sinphi[37] = 0.344125781428614011816273853050;
      sinphi[38] = 0.273895825423196448926765990921;
      sinphi[39] = 0.202208436766143128652929338032;
      sinphi[40] = 0.129516335829057343734624535465;
      sinphi[41] = 0.0565526374318492869156977554605;
      r[0] = 0.0721529908745862354223272509556;
      r[1] = 0.143929809510713310770299937611;
      r[2] = 0.214956244860518209014878381474;
      r[3] = 0.284861998032913627105722894838;
      r[4] = 0.353282612864303806645476364143;
      r[5] = 0.419861376029269252487279394561;
      r[6] = 0.484251176785734724069633434749;
      r[7] = 0.546116316660084719140405047180;
      r[8] = 0.605134259639600935725083071124;
      r[9] = 0.660997313751498133165134763741;
      r[10] = 0.713414235268957054851920877991;
      r[11] = 0.762111747194955121460328463029;
      r[12] = 0.806835964136938635279074740878;
      r[13] = 0.847353716209315048999086085822;
      r[14] = 0.883453765218616863337678011642;
      r[15] = 0.914947907206138729456102870799;
      r[16] = 0.941671956847637861818477390398;
      r[17] = 0.963486613014079993410194963574;
      r[18] = 0.980278220980255331505529382181;
      r[19] = 0.991959557593244146420718341330;
      r[20] = 0.998472332242507713517636187318;
      b[0] = 0.00410599860464908461060277949684;
      b[1] = 0.00953622030174850241182010029270;
      b[2] = 0.0149224436973574941446776781059;
      b[3] = 0.0202278695690526447570557190794;
      b[4] = 0.0254229595261130478867424429094;
      b[5] = 0.0304792406996034683629047335234;
      b[6] = 0.0353690710975921108326621811265;
      b[7] = 0.0400657351806922617605961248300;
      b[8] = 0.0445435777719658778743163659852;
      b[9] = 0.0487781407928032450274493631284;
      b[10] = 0.0527462956991740703439425390441;
      b[11] = 0.0564263693580183816464268551397;
      b[12] = 0.0597982622275866543128315457535;
      b[13] = 0.0628435580450025764093182513238;
      b[14] = 0.0655456243649089789270051078518;
      b[15] = 0.0678897033765219448553634022138;
      b[16] = 0.0698629924925941597661547863815;
      b[17] = 0.0714547142651709829218104441175;
      b[18] = 0.0726561752438041048879057614925;
      b[19] = 0.0734608134534675282640282570543;
      b[20] = 0.0738642342321728799963855611498;
      b[21] = 0.0738642342321728799963855611498;
      b[22] = 0.0734608134534675282640282570543;
      b[23] = 0.0726561752438041048879057614925;
      b[24] = 0.0714547142651709829218104441175;
      b[25] = 0.0698629924925941597661547863815;
      b[26] = 0.0678897033765219448553634022138;
      b[27] = 0.0655456243649089789270051078518;
      b[28] = 0.0628435580450025764093182513238;
      b[29] = 0.0597982622275866543128315457535;
      b[30] = 0.0564263693580183816464268551397;
      b[31] = 0.0527462956991740703439425390441;
      b[32] = 0.0487781407928032450274493631284;
      b[33] = 0.0445435777719658778743163659852;
      b[34] = 0.0400657351806922617605961248300;
      b[35] = 0.0353690710975921108326621811265;
      b[36] = 0.0304792406996034683629047335234;
      b[37] = 0.0254229595261130478867424429094;
      b[38] = 0.0202278695690526447570557190794;
      b[39] = 0.0149224436973574941446776781059;
      b[40] = 0.00953622030174850241182010029270;
      b[41] = 0.00410599860464908461060277949684;
      c[0] = 0.000374979071385528478782791895449;
      c[1] = 0.00148042771609250470783022635461;
      c[2] = 0.00325880168212035443549475549887;
      c[3] = 0.00561722226458651136966051263106;
      c[4] = 0.00843186990802530114122079800112;
      c[5] = 0.0115538444772901717308760660693;
      c[6] = 0.0148162178096408569516713326958;
      c[7] = 0.0180419483093226938448642565936;
      c[8] = 0.0210522869390115855170798894635;
      c[9] = 0.0236752808901256409603338735857;
      c[10] = 0.0257539765562596204300932905926;
      c[11] = 0.0271539374109088007667877187185;
      c[12] = 0.0277697243536779924734856541762;
      c[13] = 0.0275300345570057883780188676665;
      c[14] = 0.0264012575920126318128627787255;
      c[15] = 0.0243892818437576756183546550251;
      c[16] = 0.0215394670455981214166595076599;
      c[17] = 0.0179347891717654838664281892521;
      c[18] = 0.0136922768136826717196075182859;
      c[19] = 0.00895818487780849901089116733149;
      c[20] = 0.00390752404325489870232948311054;
    }
  }

  TF cosphi[kNumPhi];
  TF sinphi[kNumPhi];
  TF r[kNumR];
  TF b[kNumPhi];
  TF c[kNumR];
};
template <typename TF>
class PeirceQuadrature {
 public:
  using Integrand = std::function<TF(Vector3r<TF> const&)>;

  static TF integrate(Integrand integrand, TF int_radius) {
    auto res = 0.0;
    auto xi = Vector3r<TF>{};
    constexpr PeirceConst<TF> kPeirceConst;
    constexpr TF kPi = static_cast<TF>(
        3.14159265358979323846264338327950288419716939937510582097494459230781640628620899862803482534211706798214808651e+00L);

    for (U i = 0; i < kNumTheta; ++i) {
      TF theta = 2 * kPi * (i + 1) / kNumTheta;
      TF sin_theta = sin(theta);
      TF cos_theta = cos(theta);
      for (U j = 0; j < kNumPhi; ++j) {
        xi(0) = kPeirceConst.sinphi[j] * cos_theta;
        xi(1) = kPeirceConst.sinphi[j] * sin_theta;
        xi(2) = kPeirceConst.cosphi[j];
        for (U k = 0; k < kNumR; ++k) {
          TF wijk = 2 * kPi * kPeirceConst.b[j] * kPeirceConst.c[k] / kNumTheta;
          res += wijk * integrand(int_radius * kPeirceConst.r[k] * xi);
        }
      }
    }
    return res * int_radius * int_radius * int_radius;
  }
};
}  // namespace dg
}  // namespace alluvion

#endif
